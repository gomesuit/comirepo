h1.pt-3 検索

.row
  .col-7
    .bg-dark.text-white.rounded.p-3
      = search_form_for @search, url: admin_items_path do |f|
        .form-group.row
          = f.label :title_cont, 'タイトル（含む）', class: 'col-3 col-form-label'
          .col-9
            = f.text_field :title_cont, class: 'form-control'
        .form-group.row
          = f.label :title_not_cont, 'タイトル（含まない）', class: 'col-3 col-form-label'
          .col-9
            = f.text_field :title_not_cont, class: 'form-control'
        .form-group.row
          = f.label :label_name_cont, 'レーベル（含む）', class: 'col-3 col-form-label'
          .col-9
            = f.text_field :label_name_cont, class: 'form-control'
        .form-group.row
          = f.label :label_id_eq, 'レーベル', class: 'col-3 col-form-label'
          .col-9
            = f.collection_select :label_id_eq, Label.all, :id, :name, { include_blank: '指定なし' }, { class: 'form-control' }
        .form-group.row
          = f.label :introduction_cont, 'あらすじ（含む）', class: 'col-3 col-form-label'
          .col-9
            = f.text_field :introduction_cont, class: 'form-control'
        .form-group.row
          = f.label :categories_id_in, 'カテゴリ', class: 'col-3 col-form-label'
          .col-9
            = f.collection_select :categories_id_in, Category.all, :id, :name, { include_blank: '指定なし' }, { class: 'form-control' }
        = f.submit '検索する', class: 'btn btn-primary'

.pt-3
  = paginate @items
  = page_entries_info @items

.pt-3
table.table
  thead.thead-light
    tr
      th id
      th image
      th title
      th = sort_link @search, :publication_date, 'publication_date'
      th categories
      th label
      th is_adult_content
      th = sort_link @search, :adult_score, 'adult_score'
      th is_racy_content
      th = sort_link @search, :racy_score, 'racy_score'
      th = sort_link @search, :created_at, 'created_at'
      th = sort_link @search, :updated_at, 'updated_at'
      th destroy

  tbody
    - @items.each do |item|
      tr height=200
        td.align-middle = item.id
        td.align-middle
          = link_to edit_admin_item_path(item)
            - if item.medium_image
              = image_tag item.medium_image, width: 120
            - else
              = image_tag 'noimage_m.png', width: 120
        td.align-middle = item.title
        td.align-middle = item.publication_date
        td.align-middle
          - item.categories.each do |category|
            p = link_to "#{category.name}[#{category.browse_node_id}]", edit_admin_category_path(category)
        td.align-middle
          - if item.label
            = link_to item.label.name, edit_admin_label_path(item.label)
        td.align-middle = item.is_adult_content
        td.align-middle = item.adult_score.round 2
        td.align-middle = item.is_racy_content
        td.align-middle = item.racy_score.round 2
        td.align-middle = l item.created_at, format: :short
        td.align-middle = l item.updated_at, format: :short
        td.align-middle = link_to 'Destroy', admin_item_path(item), data: { confirm: 'Are you sure?' }, method: :delete, class: 'btn btn-danger'

= paginate @items
